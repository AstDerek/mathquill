<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Mathquill by AstDerek</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>Mathquill</h1>
        <p>Render LaTeX math as pure HTML/CSS that is WYSIWYG editable</p>

        <p class="view"><a href="https://github.com/AstDerek/mathquill">View the Project on GitHub <small>AstDerek/mathquill</small></a></p>


        <ul>
          <li><a href="https://github.com/AstDerek/mathquill/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/AstDerek/mathquill/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/AstDerek/mathquill">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        <p>Please note that this is an alpha version, so bugs and unimplemented features
are all over the place.</p>

<h2>Usage</h2>

<p>(Note: Requires <a href="http://jquery.com">jQuery 1.4+</a>.)</p>

<p>You just need to download the
<a href="http://laughinghan.github.com/mathquill/mathquill.css">stylesheet</a> and the
<a href="http://laughinghan.github.com/mathquill/mathquill.js">script</a>, include the
stylesheet in the head:</p>

<pre><code>&lt;link rel="stylesheet" type="text/css" href="/path/to/mathquill.css"&gt;
</code></pre>

<p>and include the script somewhere after including <a href="http://jquery.com">jQuery</a>:</p>

<pre><code>&lt;script src="/path/to/mathquill.js"&gt;&lt;/script&gt;
</code></pre>

<p>Then wherever you'd like to embed LaTeX math to be rendered in HTML:</p>

<pre><code>&lt;span class="mathquill-embedded-latex"&gt;\frac{d}{dx}\sqrt{x}&lt;/span&gt;
</code></pre>

<p>or have an editable math textbox:</p>

<pre><code>&lt;span class="mathquill-editable"&gt;f(x)=?&lt;/span&gt;
</code></pre>

<p>Note that for dynamically created elements that weren't in the HTML DOM on
document ready, you will need to call our jQuery plugin after inserting into
the visible HTML DOM:</p>

<p><code>$('&lt;span&gt;x^2&lt;/span&gt;').appendTo('body').mathquill()</code> or <code>.mathquill('editable')</code></p>

<p>MathQuill has to perform calculations based on computed CSS values. If you
mathquill-ify an element before inserting into the visible HTML DOM, then once
it is visible MathQuill will need to recalculate:</p>

<pre><code>$('&lt;span&gt;\sqrt{2}&lt;/span&gt;').mathquill().appendTo('body').mathquill('redraw')
</code></pre>

<p>Any element that has been MathQuill-ified can be reverted:</p>

<pre><code>$('.mathquill-embedded-latex').mathquill('revert');
</code></pre>

<p>Manipulating the HTML DOM inside editable math textboxes can break MathQuill.
Currently, MathQuill only supports a limited scripting API:</p>

<ul>
<li>
<p>To access the LaTeX contents of a mathquill-ified element:</p>

<p>$('x^{-1}').mathquill().mathquill('latex') === 'x^{-1}'</p>
</li>
<li>
<p>To render some LaTeX in a mathquill-ified element:</p>

<p>$('').mathquill().appendTo('body').mathquill('latex','a_n x^n')</p>
</li>
</ul><h2>Understanding The Source Code</h2>

<p>All the CSS is in <code>mathquill.css</code>. Most of it's pretty straightforward, although
fractions and a few other things are somewhat arcane. In particular, see the
Wiki pages "Fonts", "Fractions", and "Keyboard Events".</p>

<p>All the JavaScript that you actually want to read is in <code>src/</code>, <code>build/</code> just
contains a cat'ed (and eventually, minified) version of all that.</p>

<ol>
<li>First, skim <code>baseclasses.js</code> to get an idea of the virtual "math DOM".

<ul>
<li>Look over the structure of the virtual DOM tree and the utility methods on
the nodes in the tree.</li>
<li>Some of the initialization code is a bit obscure, don't worry about it.</li>
</ul>
</li>
<li>Next is how the virtual cursor deals with the DOM in <code>cursor.js</code>.

<ol>
<li>Start by reading through the tree traversal and manipulation methods

<ul>
<li>they pretty much just do what they say on the tin</li>
<li>you may want to take a peek at how they're called by
<code>RootMathBlock.prototype.keydown()</code> in <code>rootelements.js</code>

<ul>
<li>just the calls where it's obvious what it's supposed to do, like
<code>cursor.moveLeft()</code> when the left key is pressed</li>
<li>you don't have to worry about the complicated event logic yet</li>
</ul>
</li>
</ul>
</li>
<li>Now check out how <code>RootMathBlock.prototype.keypress()</code> calls
<code>Cursor.prototype.write()</code>

<ul>
<li>and how that calls <code>Cursor.prototype.insertNew()</code>
</li>
<li>and what <code>Cursor.prototype.insertNew()</code> does to commands and the tree.</li>
</ul>
</li>
</ol>
</li>
<li>Once you've seen what the virtual DOM tree is like, how it is traversed and
manipulated it, and how commands are created and inserted, you can look
over <code>commands.js</code>

<ul>
<li>perhaps comparing with what <code>Cursor.prototype.insertNew()</code> does</li>
<li>as well as what the <code>MathCommand</code>'s constructor does in <code>baseclasses.js</code>
</li>
</ul>
</li>
</ol><p>And you should be set to figure out almost everything else!</p>

<p>Some comments that are too high-level to put in the code:</p>

<ul>
<li>Event delegation is used in 2 ways:

<ul>
<li>in the HTML DOM, the root <code>span</code> element of each MathQuill thing is
delegated all the events in it's own MathQuill thing

<ul>
<li>keyboard events usually end up triggering their analogue in the virtual
DOM on the virtual cursor, which then bubble upwards</li>
</ul>
</li>
<li>in the virtual math DOM, the root MathElement is delegated most of these
virtual keyboard events

<ul>
<li>for example, <code>RootMathBlock.prototype.keydown()</code>
</li>
<li>some special commands do intercept these events, though</li>
</ul>
</li>
</ul>
</li>
<li>Keyboard events are very inconsistent between browsers, so <code>rootelements.js</code>
has some complicated but very effective logic documented in the Wiki page
"Keyboard Events".</li>
</ul><h2>Open-Source License</h2>

<p><a href="http://www.gnu.org/licenses/lgpl.html">GNU Lesser General Public License</a></p>
      </section>
      <footer>
        <p>This project is maintained by <a href="https://github.com/AstDerek">AstDerek</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="javascripts/scale.fix.js"></script>
    
  </body>
</html>